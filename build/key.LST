C51 COMPILER V6.14  KEY                                                                    06/09/2020 11:19:53 PAGE 1   


C51 COMPILER V6.14, COMPILATION OF MODULE KEY
OBJECT MODULE PLACED IN key.OBJ
COMPILER INVOKED BY: D:\SDK\kc3xm51\Tools\C51.EXE key.c SMALL WL(1) 

stmt level    source

   1          
   2          // Copyright (c) 2002-2020, Hard & Soft Technology Co.,LTD.
   3          // SPDX-License-Identifier: Apache-2.0
   4          // https://gitee.com/hsav20/kc3xm51.git
   5          // https://github.com/hsav20/kc3xm51.git
   6          // http://www,hsav.com/download/kc3xm51.zip
   7          
   8          #include "main.h"           
   9          
  10          
  11          void MKEY_Initialize(){										  
  12   1      }	  
  13          void MKEY_10msTimer(BYTE baseTimer){   						// B3=1000ms B2=500ms B1=100ms B0=10ms 
  14   1      	MPKey_Scan();
  15   1      	if (gDIP_MenuLock > 0){
  16   2      		if (!FSYS_Standby){									// ≤ª «‘⁄¥˝ª˙ƒ£ Ω
  17   3      			if ((baseTimer & 0x02) > 0){					// 100ms ±º‰
  18   4      				--gDIP_MenuLock;
  19   4      			}
  20   3      		}
  21   2      		return;	
  22   2      	}
  23   1      	if (FSYS_Standby){
  24   2      		if (FRmDecodDone){
  25   3      			FRmDecodDone = 0;
  26   3      			if (GRmCodeData == cRmKey_Standby){
  27   4      				MKCM_SetPowerOn();						// KCMø™ª˙
  28   4      			}
  29   3      		}
  30   2      	   	if (FPKeyDecodeDone){
  31   3      			FPKeyDecodeDone = 0;
  32   3      //			FDirectUp = 0;
  33   3      			FPKeyStep = 1;
  34   3      			if (GPKeyData == cPanKey_InputSource){
  35   4      				MKCM_SetPowerOn();						// KCMø™ª˙
  36   4      			}
  37   3      		}
  38   2      		return;
  39   2      	}
  40   1         	if (FPKeyDecodeDone){
  41   2      		FPKeyDecodeDone = 0;
  42   2      //		FDirectUp = 0;
  43   2      		FPKeyStep = 1;
  44   2      //MDEBUG(0xaa);MDEBUG(GPKeyData);
  45   2      
  46   2      		switch (GPKeyData){
  47   3      		case cPanKey_InputSource:
  48   3      			MAUD_MixInputSource(INPUT_SWITCH_NONE);         // —≠ª∑∑Ω Ω
  49   3      			break;
  50   3      		case cPanKey_Stereo:
  51   3      			MDIP_MenuSelect(cMenu_Surround2Ch, MENU_NORMAL);
  52   3      			break;
  53   3      		case cPanKey_SurroundMode:
  54   3      			MDIP_MenuSelect(cMenu_Surround8Ch, MENU_NORMAL);
  55   3      			break;
C51 COMPILER V6.14  KEY                                                                    06/09/2020 11:19:53 PAGE 2   

  56   3       		case cPanKey_SoundEffect:
  57   3      			MDIP_MenuSelect(cMenu_SoundEffect, MENU_NORMAL);
  58   3      			break;
  59   3      
  60   3      		case cPanKey_PlayPause:
  61   3      			break;
  62   3      		case cPanKey_SkipDown:
  63   3      			break;
  64   3      		case cPanKey_SkipUp:
  65   3      			break;
  66   3      
  67   3        		case cPanKey_AudioMute: 							// MUTE
  68   3      			if (gDIP_MenuSelect >= cMenu_MasterVolume && gDIP_MenuSelect <= cMenu_MicReverb){		// “—æ≠‘⁄JOG≤Àµ• 
  69   4      				MDIP_MenuSelect(cMenu_Restore, MENU_NORMAL);
  70   4      			}
  71   3      			else {
  72   4      				MKEY_AudioMute();
  73   4      			}
  74   3       			break;
  75   3      
  76   3        		case cPanKey_JogMenu:								// JOG
  77   3      			
  78   3      			if (gDIP_MenuSelect < cMenu_MasterVolume || gDIP_MenuSelect > cMenu_MicVolume2){		// ªπ√ª”–Ω¯»ÎJOG≤Àµ• 
  79   4      				MDIP_MenuSelect(cMenu_MasterVolume, MENU_NORMAL);
  80   4      			}
  81   3      			else {
  82   4      				if (++gDIP_MenuSelect > cMenu_MicVolume2){
  83   5      					gDIP_MenuSelect = cMenu_MasterVolume;
  84   5      				}
  85   4      				MDIP_MenuSelect(gDIP_MenuSelect, MENU_NORMAL);
  86   4      			}
  87   3      			break;
  88   3      		}
  89   2      	}
  90   1          
  91   1          if ((gRmKeyContinCanclTm != 0) && (++gRmKeyContinCanclTm > 60)){	
  92   2              gRmKeyContinCanclTm = 0;
  93   2      		gRmKeyContinSpeed = 0;
  94   2          }
  95   1      	if (FRmDecodDone){
  96   2      		BYTE gLocal_1;
  97   2      		FRmDecodDone = 0;
  98   2      //MDEBUG(0xf9);MDEBUG(GRmCodeData);
  99   2      		switch (GRmCodeData){
 100   3      		case cRmKey_Standby:
 101   3      			FSYS_Standby = ~FSYS_Standby;
 102   3      			if (FSYS_Standby){
 103   4      				MDIP_MenuSelect(cMenu_Standby, MENU_NORMAL);
 104   4      			}
 105   3      			else {
 106   4      				MKCM_WriteRegister(KCM_POWER_ON, 1);
 107   4      			    MDIP_MenuSelect(cMenu_PowerOn, MENU_NORMAL);
 108   4      				gDIP_MenuLock = 30;							// ‘› ±À¯∂®œ‘ æ3√Î
 109   4      			}
 110   3      			break;
 111   3      		case cRmKey_Brightness:
 112   3      			gLocal_1 = (gDIP_MenuSelect == cMenu_Brightness) ? MENU_ADJ_UP : MENU_NORMAL;
 113   3      			MDIP_MenuSelect(cMenu_Brightness, gLocal_1);
 114   3      			break;
 115   3      		case cRmKey_FactorySet:
 116   3      			MDIP_WriteString(" RESET");
 117   3      			MDIP_ScreenUpdata();
C51 COMPILER V6.14  KEY                                                                    06/09/2020 11:19:53 PAGE 3   

 118   3      			MKCM_FactorySet();
 119   3      			break;
 120   3      		case cRmKey_MicCtrl:
 121   3      			if (CUSTOM_CODE != 0x44443000){			// ≤ª «’‚∏ˆ∞Ê±æ£¨æ…“Ù∆µ∞Â£¨÷–÷√≥¨µÕ“Ù”Îª∑»∆…˘ ∂‘µ˜   π”√PT2258“Ù¡øIC
 122   4      				if (gDIP_MenuSelect < cMenu_MicVolume1){	    // ªπ√ª”–Ω¯»ÎMic≤Àµ• 
 123   5      					MDIP_MenuSelect(cMenu_MicVolume1, MENU_NORMAL);
 124   5      				}else {
 125   5      					if (++gDIP_MenuSelect > cMenu_MicReverb){
 126   6      						gDIP_MenuSelect = cMenu_MicVolume1;
 127   6      					}
 128   5      					MDIP_MenuSelect(gDIP_MenuSelect, MENU_NORMAL);
 129   5      				}
 130   4      			}
 131   3      			break;
 132   3      		case cRmKey_TrimUp:
 133   3                  if (gDIP_MenuSelect >= cMenu_ChTrimFL && gDIP_MenuSelect <= cMenu_ChTrimSL){	// “—æ≠Ω¯»Î…˘µ¿Œ¢
             -µ˜≤Àµ• 
 134   4                      gRmKeyContinCanclTm = 1;
 135   4      				MDIP_MenuSelect(gDIP_MenuSelect, MENU_ADJ_UP);
 136   4                  }else if (gDIP_MenuSelect >= cMenu_TToneFL && gDIP_MenuSelect <= cMenu_TToneSL){	// “—æ≠Ω¯»Î≤‚
             - ‘‘Î“Ù≤Àµ• 
 137   4      				gRmKeyContinCanclTm = 1;
 138   4      				MDIP_MenuSelect(gDIP_MenuSelect, MENU_ADJ_UP);
 139   4      			}
 140   3      			break;
 141   3      		case cRmKey_TrimDown:
 142   3                  if (gDIP_MenuSelect >= cMenu_ChTrimFL && gDIP_MenuSelect <= cMenu_ChTrimSL){	// “—æ≠Ω¯»Î…˘µ¿Œ¢
             -µ˜≤Àµ• 
 143   4                      gRmKeyContinCanclTm = 1;
 144   4      				MDIP_MenuSelect(gDIP_MenuSelect, MENU_ADJ_DOWN);
 145   4                  }else if (gDIP_MenuSelect >= cMenu_TToneFL && gDIP_MenuSelect <= cMenu_TToneSL){	// “—æ≠Ω¯»Î≤‚
             - ‘‘Î“Ù≤Àµ• 
 146   4      				gRmKeyContinCanclTm = 1;
 147   4      				MDIP_MenuSelect(gDIP_MenuSelect, MENU_ADJ_DOWN);
 148   4      			}
 149   3      			break;
 150   3      		case cRmKey_MicUp:
 151   3      			if (CUSTOM_CODE != 0x44443000){			// ≤ª «’‚∏ˆ∞Ê±æ£¨æ…“Ù∆µ∞Â£¨÷–÷√≥¨µÕ“Ù”Îª∑»∆…˘ ∂‘µ˜   π”√PT2258“Ù¡øIC
 152   4      				if (gDIP_MenuSelect >= cMenu_MicVolume1 && gDIP_MenuSelect <= cMenu_MicReverb){	// “—æ≠Ω¯»ÎMic≤Àµ• 
 153   5      					gRmKeyContinCanclTm = 1;
 154   5      					MDIP_MenuSelect(gDIP_MenuSelect, MENU_ADJ_UP);
 155   5      				}
 156   4      			}
 157   3      			break;
 158   3      		case cRmKey_MicDown:
 159   3      			if (CUSTOM_CODE != 0x44443000){			// ≤ª «’‚∏ˆ∞Ê±æ£¨æ…“Ù∆µ∞Â£¨÷–÷√≥¨µÕ“Ù”Îª∑»∆…˘ ∂‘µ˜   π”√PT2258“Ù¡øIC
 160   4      				if (gDIP_MenuSelect >= cMenu_MicVolume1 && gDIP_MenuSelect <= cMenu_MicReverb){	// “—æ≠Ω¯»ÎMic≤Àµ• 
 161   5      					gRmKeyContinCanclTm = 1;
 162   5      					MDIP_MenuSelect(gDIP_MenuSelect, MENU_ADJ_DOWN);
 163   5      				}
 164   4      			}
 165   3      			break;
 166   3      		case cRmKey_VolumeUp:
 167   3      			gRmKeyContinCanclTm = 1;
 168   3      			gLocal_1 = (gDIP_MenuSelect == cMenu_MasterVolume) ? MENU_ADJ_UP : MENU_NORMAL;
 169   3      			MDIP_MenuSelect(cMenu_MasterVolume, gLocal_1);
 170   3      			break;
 171   3      		case cRmKey_VolumeDown:
 172   3      			if (!FSYS_MuteEnable){
 173   4      				gRmKeyContinCanclTm = 1;
 174   4      				gLocal_1 = (gDIP_MenuSelect == cMenu_MasterVolume) ? MENU_ADJ_DOWN : MENU_NORMAL;
 175   4      				MDIP_MenuSelect(cMenu_MasterVolume, gLocal_1);
C51 COMPILER V6.14  KEY                                                                    06/09/2020 11:19:53 PAGE 4   

 176   4      			}
 177   3      			break;
 178   3      
 179   3      		case cRmKey_TestTone:
 180   3      			MKEY_TestTone();
 181   3      			break;
 182   3      		case cRmKey_AudioMute:
 183   3          		MKEY_AudioMute();
 184   3      			break;
 185   3      		case cRmKey_MeunCtrl:
 186   3      			if (gDIP_MenuSelect >= cMenu_LipSync && gDIP_MenuSelect <= cMenu_SpeakFilter){	// “—æ≠Ω¯»Î…Ë÷√≤Àµ• 
 187   4      				MDIP_MenuSelect(cMenu_Restore, MENU_NORMAL);
 188   4      			}
 189   3      			else {
 190   4      				MDIP_MenuSelect(cMenu_LipSync, MENU_NORMAL);
 191   4      			}
 192   3      			break;
 193   3      		case cRmKey_MeunUp:
 194   3      			if (gDIP_MenuSelect >= cMenu_LipSync && gDIP_MenuSelect <= cMenu_SpeakFilter){	// “—æ≠Ω¯»Î…Ë÷√≤Àµ• 
 195   4      				++gDIP_MenuSelect;
 196   4      				if (gDIP_MenuSelect == cMenu_DelayCenter){	// ≤Àµ•÷–÷√…˘µ¿—”≥Ÿ ±º‰µ˜’˚
 197   5      					if (gDIP_SpeakSetup[1] == 0){			// √ª”–÷–÷√¿Æ∞»
 198   6      						++gDIP_MenuSelect;					// Ã¯π˝
 199   6      					}
 200   5      				}
 201   4      				if (gDIP_MenuSelect == cMenu_DelaySurround){	// ≤Àµ•ª∑»∆…˘µ¿—”≥Ÿ ±º‰µ˜’˚
 202   5      					if (gDIP_SpeakSetup[3] == 0){			// √ª”–ª∑»∆…˘¿Æ∞»
 203   6      						++gDIP_MenuSelect;					// Ã¯π˝
 204   6      					}
 205   5      				}
 206   4      				if (gDIP_MenuSelect == cMenu_DelayBack){	// ≤Àµ•∫Û÷√…˘µ¿—”≥Ÿ ±º‰µ˜’˚
 207   5      					if (gDIP_SpeakSetup[4] == 0){			// √ª”–∫Û÷√¿Æ∞»
 208   6      						++gDIP_MenuSelect;					// Ã¯π˝
 209   6      					}
 210   5      				}
 211   4      				if (gDIP_MenuSelect > cMenu_SpeakFilter){
 212   5      					gDIP_MenuSelect = cMenu_LipSync;
 213   5      				}
 214   4      				MDIP_MenuSelect(gDIP_MenuSelect, MENU_NORMAL);
 215   4      				gDIP_MenuTimer = 50;
 216   4      			}
 217   3      //MDEBUG(0xa9);MDEBUG(gDIP_MenuSelect);
 218   3      			break;
 219   3      		case cRmKey_MeunDown:
 220   3      			if (gDIP_MenuSelect >= cMenu_LipSync && gDIP_MenuSelect <= cMenu_SpeakFilter){	// “—æ≠Ω¯»Î…Ë÷√≤Àµ• 
 221   4      				--gDIP_MenuSelect;
 222   4      				if (gDIP_MenuSelect == cMenu_DelayBack){	// ≤Àµ•∫Û÷√…˘µ¿—”≥Ÿ ±º‰µ˜’˚
 223   5      					if (gDIP_SpeakSetup[4] == 0){			// √ª”–∫Û÷√¿Æ∞»
 224   6      						--gDIP_MenuSelect;					// Ã¯π˝
 225   6      					}
 226   5      				}
 227   4      				if (gDIP_MenuSelect == cMenu_DelaySurround){	// ≤Àµ•ª∑»∆…˘µ¿—”≥Ÿ ±º‰µ˜’˚
 228   5      					if (gDIP_SpeakSetup[3] == 0){			// √ª”–ª∑»∆…˘¿Æ∞»
 229   6      						--gDIP_MenuSelect;					// Ã¯π˝
 230   6      					}
 231   5      				}
 232   4      
 233   4      				if (gDIP_MenuSelect == cMenu_DelayCenter){	// ≤Àµ•÷–÷√…˘µ¿—”≥Ÿ ±º‰µ˜’˚
 234   5      					if (gDIP_SpeakSetup[1] == 0){			// √ª”–÷–÷√¿Æ∞»
 235   6      						--gDIP_MenuSelect;					// Ã¯π˝
 236   6      					}
 237   5      				}
C51 COMPILER V6.14  KEY                                                                    06/09/2020 11:19:53 PAGE 5   

 238   4      				if (gDIP_MenuSelect < cMenu_LipSync){
 239   5      					gDIP_MenuSelect = cMenu_SpeakFilter;
 240   5      				}
 241   4      				MDIP_MenuSelect(gDIP_MenuSelect, MENU_NORMAL);
 242   4      				gDIP_MenuTimer = 50;
 243   4      			}
 244   3      //MDEBUG(0xa8);MDEBUG(gDIP_MenuSelect);
 245   3      			break;
 246   3      		case cRmKey_MeunLeft:
 247   3      			if (gDIP_MenuSelect >= cMenu_LipSync && gDIP_MenuSelect <= cMenu_SpeakFilter){	// “—æ≠Ω¯»Î…Ë÷√≤Àµ• 
 248   4      				gRmKeyContinCanclTm = 1;
 249   4      				MDIP_MenuSelect(gDIP_MenuSelect, 3);
 250   4      			}
 251   3      			break;
 252   3      		case cRmKey_MeunRight:
 253   3      			if (gDIP_MenuSelect >= cMenu_LipSync && gDIP_MenuSelect <= cMenu_SpeakFilter){	// “—æ≠Ω¯»Î…Ë÷√≤Àµ• 
 254   4      				gRmKeyContinCanclTm = 1;
 255   4      				MDIP_MenuSelect(gDIP_MenuSelect, 4);
 256   4      			}
 257   3      			break;
 258   3      		case cRmKey_TrimCtrl:                               // …˘µ¿Œ¢µ˜
 259   3      			if (gDIP_MenuSelect < cMenu_ChTrimFL || gDIP_MenuSelect > cMenu_ChTrimSL){	    // ªπ√ª”–Ω¯»Î…˘µ¿Œ¢µ˜≤Àµ
             -• 
 260   4                  	MAUD_AutoCanclTestTone();
 261   4      				MDIP_MenuSelect(cMenu_ChTrimFL, MENU_NORMAL);   // Ω¯»Î…˘µ¿Œ¢µ˜≤Àµ• 
 262   4      			}else {                                         // “—æ≠Ω¯»Î…˘µ¿Œ¢µ˜≤Àµ• 
 263   4                      BYTE next = MDIP_GetNextChannel(gDIP_MenuSelect - cMenu_ChTrimFL);    
 264   4      //MDEBUG(0xee);MDEBUG(gDIP_MenuSelect - cMenu_ChTrimFL);MDEBUG(next);//MDEBUG(gDIP_SpeakSetup[1]);MDEBUG(g
             -DIP_SpeakSetup[2]);MDEBUG(gDIP_SpeakSetup[3]);MDEBUG(gDIP_SpeakSetup[4]);MDEBUG(gDIP_MenuSelect);MDEBUG(cMenu_ChTrimFL);
 265   4                      gDIP_MenuSelect = next + cMenu_ChTrimFL;
 266   4      				MDIP_MenuSelect(gDIP_MenuSelect, MENU_NORMAL);
 267   4      			}
 268   3      			break;
 269   3      		case cRmKey_Record:                                        // ¬º“Ùº∞‘›Õ£π¶ƒ‹£¨œ÷‘⁄‘› ±”√¿¥≤‚ ‘I2C◊‹œﬂ∂¡»
             -°
 270   3      			FDIP_ScreenFill = ~FDIP_ScreenFill;
 271   3      			if (!FDIP_ScreenFill){
 272   4      				MDIP_ScreenFill(0xff);	
 273   4      				MDIP_ScreenUpdata();
 274   4      			}else {
 275   4      				MDIP_MenuSelect(cMenu_Restore, 0);
 276   4      			}
 277   3      			break;
 278   3      		case cRmKey_Random:
 279   3      			MKCM_WriteRegister(KCM_PLAY_OPERATE, KCM_PLAY_RANDOM0);  // ∂‡√ΩÃÂÀÊª˙≤•∑≈£¨ ±º‰0
 280   3      			break;
 281   3      		case cRmKey_Repeat:
 282   3      			MKCM_WriteRegister(KCM_PLAY_OPERATE, KCM_PLAY_REPEAT0);  // ∂‡√ΩÃÂ÷ÿ∏¥≤•∑≈£¨¿‡–Õ0
 283   3      			break;
 284   3      
 285   3      		case cRmKey_Stop:
 286   3                  MKCM_WriteRegister(KCM_PLAY_OPERATE, KCM_PLAY_STOP);  // ∂‡√ΩÃÂ≤•∑≈Õ£÷π
 287   3      			break;
 288   3      		case cRmKey_PlayPause:
 289   3                  MKCM_WriteRegister(KCM_PLAY_OPERATE, KCM_PLAY_PAUSE);  // ∂‡√ΩÃÂ≤•∑≈‘›Õ£/≤•∑≈
 290   3      			break;
 291   3      		case cRmKey_FastBack:
 292   3      			//MKCM_PlayOperate(KCM_PLAY_FAST_BACK);  // ∂‡√ΩÃÂ≤•∑≈≤•∑≈øÏÕÀ
 293   3      			break;
 294   3      		case cRmKey_FastForward:
 295   3      			MKCM_WriteRegister(KCM_PLAY_OPERATE, KCM_PLAY_FAST_FORW0);  // ∂‡√ΩÃÂ≤•∑≈øÏΩ¯
 296   3      			break;
C51 COMPILER V6.14  KEY                                                                    06/09/2020 11:19:53 PAGE 6   

 297   3      		case cRmKey_SkipDown:
 298   3      			MKCM_WriteRegister(KCM_PLAY_OPERATE, KCM_PLAY_SKIP_DOWN);  // ∂‡√ΩÃÂ≤•∑≈∫Û“ª ◊
 299   3      			break;
 300   3      		case cRmKey_SkipUp:
 301   3      			MKCM_WriteRegister(KCM_PLAY_OPERATE, KCM_PLAY_SKIP_UP);  // ∂‡√ΩÃÂ≤•∑≈«∞“ª ◊
 302   3      			break;
 303   3      		case cRmKey_SoundEffect:
 304   3      			MDIP_MenuSelect(cMenu_SoundEffect, MENU_NORMAL);
 305   3      			break;
 306   3      		case cRmKey_NightMode:
 307   3      			MDIP_MenuSelect(cMenu_NightMode, MENU_NORMAL);
 308   3      			break;
 309   3      		case cRmKey_NoiseSignal:
 310   3      			MDIP_MenuSelect(cMenu_NoiseSignal, MENU_NORMAL);
 311   3      			break;
 312   3      		case cRmKey_MediaType:
 313   3      			break;
 314   3      		case cRmKey_Stereo:
 315   3      			MDIP_MenuSelect(cMenu_Surround2Ch, MENU_NORMAL);
 316   3      			break;
 317   3      		case cRmKey_Surround:
 318   3      			MDIP_MenuSelect(cMenu_Surround8Ch, MENU_NORMAL);
 319   3      			break;
 320   3      		case cRmKey_VideoSrc:
 321   3      			MKEY_VideoSelect();
 322   3      			break;
 323   3      		case cRmKey_InputNet:
 324   3      			MAUD_MixInputSource(INPUT_SWITCH_UDISK);
 325   3      			break;
 326   3      		case cRmKey_InputHdmi1:
 327   3      			MAUD_MixInputSource(INPUT_SWITCH_HDMI1);
 328   3      			break;
 329   3      		case cRmKey_InputHdmi2:
 330   3      			MAUD_MixInputSource(INPUT_SWITCH_HDMI2);
 331   3      			break;
 332   3      		case cRmKey_InputHdmi3:
 333   3      			MAUD_MixInputSource(INPUT_SWITCH_HDMI3);
 334   3      			break;
 335   3      		case cRmKey_InputHdmiArc:
 336   3      			MAUD_MixInputSource(INPUT_SWITCH_H_ARC);
 337   3      			break;
 338   3      		case cRmKey_InputOptica:
 339   3      			MAUD_MixInputSource(INPUT_SWITCH_OPTIC);
 340   3      			break;
 341   3      		case cRmKey_InputCoaxal1:
 342   3      			MAUD_MixInputSource(INPUT_SWITCH_COA1);
 343   3      			break;
 344   3      		case cRmKey_InputCoaxal2:
 345   3      			MAUD_MixInputSource(INPUT_SWITCH_COA2);
 346   3      			break;
 347   3      		case cRmKey_InputAux:
 348   3      			MAUD_MixInputSource(INPUT_SWITCH_AUX);
 349   3      			break;
 350   3      
 351   3      		}
 352   2      	}
 353   1      	if (FKeyJogSwOK){
 354   2      		FKeyJogSwOK = 0;
 355   2      		if (gDIP_MenuSelect >= cMenu_MasterVolume && gDIP_MenuSelect <= cMenu_MicVolume2){		// “—æ≠Ω¯»ÎJOG≤Àµ• 
 356   3      			MDIP_MenuSelect(gDIP_MenuSelect, FKeyJogUp ? 4 : 3);
 357   3      		}
 358   2      		else {
C51 COMPILER V6.14  KEY                                                                    06/09/2020 11:19:53 PAGE 7   

 359   3      			MDIP_MenuSelect(cMenu_MasterVolume, MENU_NORMAL);
 360   3      		}
 361   2      	}
 362   1          return;
 363   1      }	  
 364          void MKEY_AudioMute(){
 365   1      	BYTE gLocal_1;
 366   1      	FSYS_MuteEnable = ~FSYS_MuteEnable;
 367   1      	gLocal_1 = FSYS_MuteEnable ? 4 : 3;
 368   1      	MDIP_MenuSelect(cMenu_AudioMute, gLocal_1);
 369   1      	if (!FSYS_MuteEnable){									// Ω‚≥˝æ≤“Ù
 370   2      		MDIP_MenuSelect(cMenu_MasterVolume, MENU_NORMAL);
 371   2      	}
 372   1          MAUD_AutoCanclTestTone();
 373   1          return;
 374   1      }
 375          void MKEY_TestTone(){                                       // MENU_MODE mode
 376   1      	FSYS_TestTone = ~FSYS_TestTone;
 377   1      
 378   1      	if (FSYS_TestTone){										// ¥Úø™‘Î“Ù≤‚ ‘
 379   2      		MDIP_MenuSelect(cMenu_TToneFL, MENU_NORMAL);
 380   2              MAUD_TestToneChannel(0);
 381   2      //MDEBUG(0x99);MDEBUG(gDIP_MenuSelect);MDEBUG(gDIP_MenuTimer);MDEBUG(FSYS_TestTone);
 382   2      
 383   2      	}
 384   1      	else {													// πÿ±’‘Î“Ù≤‚ ‘
 385   2      		MDIP_MenuSelect(cMenu_Restore, MENU_NORMAL);
 386   2      		MAUD_TestToneChannel(0xff);
 387   2      	}
 388   1          return;
 389   1      }
 390          
 391          CONST_CHAR Tab_VideoSelect[] = {
 392          	0x01,0x02,0x04,
 393          };
 394          void MKEY_VideoSelect(){
 395   1      	if (mINPUT_SWITCH < INPUT_SWITCH_HDMI1){
 396   2      		BYTE gLocal_1 = gAUD_AutoInputSrc >> 5;					// B7:B5Œ™—°‘Òµƒ ”∆µ
 397   2      		BYTE gLocal_2 = gAUD_AutoInputSrc & 0x07;				// B4:B0Œ™≤Â»Îµƒ ”∆µŒª
 398   2      		BYTE gLocal_3 = 0;
 399   2      		do {
 400   3      			if (++gLocal_1 > 2){
 401   4      				gLocal_1 = 0;
 402   4      			}
 403   3      			if (gLocal_2 & Tab_VideoSelect[gLocal_1]){			// —°‘Òµƒ ”∆µ”–≤Â»Î
 404   4      				MKCM_WriteRegister(KCM_INPUT_VIDEO, (gLocal_1 << 5) | gLocal_2);
 405   4      			    return;
 406   4      			}
 407   3      		} while (++gLocal_3 < 3);
 408   2      	    MDIP_MenuSelect(cMenu_VideoSrc, MENU_NORMAL);
 409   2      	}
 410   1      	else {
 411   2      		MDIP_MenuSelect(cMenu_Restore, MENU_NORMAL);
 412   2      	}
 413   1          return;
 414   1      }
 415          
 416          void MPKey_Scan(){
 417   1          BYTE gLocal_1;
 418   1          BYTE gLocal_2;
 419   1      
 420   1      	if(gKeyScan == 0){
C51 COMPILER V6.14  KEY                                                                    06/09/2020 11:19:53 PAGE 8   

 421   2      		HAL_PKEY_0(0);
 422   2      		HAL_PKEY_1(1);
 423   2      		HAL_PKEY_2(1);
 424   2      	}		
 425   1      	else if(gKeyScan == 1){
 426   2      		HAL_PKEY_0(1);
 427   2      		HAL_PKEY_1(0);
 428   2      		HAL_PKEY_2(1);
 429   2      	}		
 430   1      	else {
 431   2      		HAL_PKEY_0(1);
 432   2      		HAL_PKEY_1(1);
 433   2      		HAL_PKEY_2(0);
 434   2      	}
 435   1      
 436   1      	gLocal_1 = 0;
 437   1      	if(!HAL_IN_PKEY_0()) gLocal_1 |= 0x01;		
 438   1      	if(!HAL_IN_PKEY_1()) gLocal_1 |= 0x02;		
 439   1      	if(!HAL_IN_PKEY_2()) gLocal_1 |= 0x04;		
 440   1      	if(!HAL_IN_PKEY_3()) gLocal_1 |= 0x08;		
 441   1      
 442   1          if (gLocal_1){
 443   2              gLocal_1 = (gKeyScan << 4) + gLocal_1;    
 444   2              if (GPKeyData == gLocal_1){
 445   3                  if (++gPKeyConfirmTm > 8){ 
 446   4      		        if (!FPKeyStep){
 447   5      	                FPKeyDecodeDone = 1;
 448   5      	            }
 449   4      				gPKeyConfirmTm = 0;
 450   4                  }
 451   3              }
 452   2      		else {
 453   3      			FPKeyStep = 0; 
 454   3      			gPKeyConfirmTm = 0; 
 455   3      			GPKeyData = gLocal_1;
 456   3      		}
 457   2          }
 458   1          else{ 
 459   2              if (++gKeyScan > 2){ 
 460   3                  gKeyScan = 0;  
 461   3              }           
 462   2      		FPKeyStep = 0; 
 463   2      		gPKeyConfirmTm = 0; 
 464   2          }
 465   1          return;
 466   1      }
 467          void MKEY_CheckJop(){										// –˝◊™∞¥≈• –˝◊™
 468   1          if (!FKeyJopInputEnl){
 469   2              if (HAL_IN_JOP0() && HAL_IN_JOP1() && (++gKeyJopInputTm > 3)){
 470   3                  gKeyJopInputTm = 0; 
 471   3                  FKeyJopInputEnl = 1;
 472   3              }
 473   2              FKeyJopSta00 = 0;
 474   2              FKeyJopSta01 = 0;
 475   2          }                 
 476   1          else if (HAL_IN_JOP0() != HAL_IN_JOP1()){
 477   2              if (FKeyJopInputEnl){
 478   3                  FKeyJogUp = HAL_IN_JOP1();
 479   3                  if ((FKeyJogUp == FKeyJogUpSave) || (gKeyJopLockTm == 0)){
 480   4                      FKeyJogSwOK = 1;
 481   4                  }
 482   3                  FKeyJogUpSave = FKeyJogUp;
C51 COMPILER V6.14  KEY                                                                    06/09/2020 11:19:53 PAGE 9   

 483   3                  gKeyJopLockTm = 3;
 484   3                  gKeyJopInputTm = 0;
 485   3                  FKeyJopInputEnl = 0;
 486   3                  FKeyJopSta01 = 0;
 487   3              }
 488   2              else {
 489   3                  if (FKeyJopSta01){
 490   4                      gKeyJopLockTm = 3;
 491   4                      gKeyJopInputTm = 0;                          
 492   4                      FKeyJopInputEnl = 0;
 493   4                  }
 494   3                  FKeyJopSta01 = 1;
 495   3              }                                
 496   2              FKeyJopSta00 = 0;
 497   2          }
 498   1          else if (!HAL_IN_JOP0() && !HAL_IN_JOP1()){ 
 499   2              if (FKeyJopSta00){
 500   3                  gKeyJopLockTm = 3;
 501   3                  gKeyJopInputTm = 0; 
 502   3                  FKeyJopInputEnl = 0;
 503   3              }
 504   2              FKeyJopSta00 = 1;
 505   2              FKeyJopSta01 = 0;
 506   2          }
 507   1          return;
 508   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   1712    ----
   CONSTANT SIZE    =     10    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       7
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
